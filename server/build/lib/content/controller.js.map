{"version":3,"sources":["../../../src/lib/content/controller.js"],"names":["findAll","req","res","next","query","result","map","item","html","markdown","images","tag","status","featured","removed","createdByID","json","console","log","findAllByCategory","category","params","id"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;;;AAEA,IAAMA;AAAA,sFAAU,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAES,kBAAeH,OAAf,CAAuB,4BAAWC,IAAIG,KAAf,+BAAvB,CAFT;;AAAA;AAENC,kBAFM;;AAGZA,mBAAOC,GAAP,CAAW,gBAAQ;AACjB,qBAAOC,KAAKC,IAAZ;AACA,qBAAOD,KAAKE,QAAZ;AACA,qBAAOF,KAAKG,MAAZ;AACA,qBAAOH,KAAKI,GAAZ;AACA,qBAAOJ,KAAKK,MAAZ;AACA,qBAAOL,KAAKM,QAAZ;AACA,qBAAON,KAAKO,OAAZ;AACA,qBAAOP,KAAKQ,WAAZ;AACA,qBAAOR,IAAP;AACD,aAVD;AAWAL,gBAAIc,IAAJ,CAAS,0BAAaX,MAAb,CAAT;AAdY;AAAA;;AAAA;AAAA;AAAA;;AAgBZY,oBAAQC,GAAR;AACAf,iBAAK,gCAAmB,MAAnB,EAA2B,MAA3B,CAAL;;AAjBY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAV;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAqBA,IAAMgB;AAAA,uFAAoB,kBAAOlB,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAED,kBAAeH,OAAf,CAAuB,4BAAWC,IAAIG,KAAf,+BAAvB,EAAsE;AACzFgB,wBAAUnB,IAAIoB,MAAJ,CAAWC;AADoE,aAAtE,CAFC;;AAAA;AAEhBjB,kBAFgB;;AAKtBA,mBAAOC,GAAP,CAAW,gBAAQ;AACjB,qBAAOC,KAAKC,IAAZ;AACA,qBAAOD,KAAKE,QAAZ;AACA,qBAAOF,KAAKG,MAAZ;AACA,qBAAOH,KAAKI,GAAZ;AACA,qBAAOJ,KAAKK,MAAZ;AACA,qBAAOL,KAAKM,QAAZ;AACA,qBAAON,KAAKO,OAAZ;AACA,qBAAOP,KAAKQ,WAAZ;AACA,qBAAOR,IAAP;AACD,aAVD;AAWAL,gBAAIc,IAAJ,CAAS,0BAAaX,MAAb,CAAT;AAhBsB;AAAA;;AAAA;AAAA;AAAA;;AAkBtBY,oBAAQC,GAAR;AACAf,iBAAK,gCAAmB,MAAnB,EAA2B,MAA3B,CAAL;;AAnBsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAuBe;AACbH,kBADa;AAEbmB;AAFa,C","file":"controller.js","sourcesContent":["import contentManager from './manager'\nimport { getFromReq } from '../util/pagination'\nimport { formatResult, handlerCustomError } from '../util/format'\nimport { CONTENT_LIMIT_DEFAULT } from '../util/const'\n\nconst findAll = async (req, res, next) => {\n  try {\n    const result = await contentManager.findAll(getFromReq(req.query, CONTENT_LIMIT_DEFAULT ))\n    result.map(item => {\n      delete item.html\n      delete item.markdown\n      delete item.images\n      delete item.tag\n      delete item.status\n      delete item.featured\n      delete item.removed\n      delete item.createdByID\n      return item\n    })\n    res.json(formatResult(result))\n  } catch (e) {\n    console.log(e)\n    next(handlerCustomError(104001, '查询失败'))\n  }\n}\n\nconst findAllByCategory = async (req, res, next) => {\n  try {\n    const result = await contentManager.findAll(getFromReq(req.query, CONTENT_LIMIT_DEFAULT ), {\n      category: req.params.id\n    })\n    result.map(item => {\n      delete item.html\n      delete item.markdown\n      delete item.images\n      delete item.tag\n      delete item.status\n      delete item.featured\n      delete item.removed\n      delete item.createdByID\n      return item\n    })\n    res.json(formatResult(result))\n  } catch (e) {\n    console.log(e)\n    next(handlerCustomError(104002, '查询失败'))\n  }\n}\n\nexport default {\n  findAll,\n  findAllByCategory\n}\n"]}