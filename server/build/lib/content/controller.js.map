{"version":3,"sources":["../../../src/lib/content/controller.js"],"names":["findAll","req","res","next","query","result","list","map","_id","item","createdAt","hits","title","json","console","log","findAllByCategory","category","params","id"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;;;AAEA,IAAMA;AAAA,sFAAU,iBAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAES,kBAAeH,OAAf,CAAuB,4BAAWC,IAAIG,KAAf,+BAAvB,CAFT;;AAAA;AAENC,kBAFM;;AAGZA,mBAAOC,IAAP,GAAcD,OAAOC,IAAP,CAAYC,GAAZ,CAAgB,gBAAQ;AACpC,qBAAO;AACLC,qBAAKC,KAAKD,GADL;AAELE,2BAAWD,KAAKC,SAFX;AAGLC,sBAAMF,KAAKE,IAHN;AAILC,uBAAOH,KAAKG;AAJP,eAAP;AAMD,aAPa,CAAd;AAQAV,gBAAIW,IAAJ,CAAS,0BAAaR,MAAb,CAAT;AAXY;AAAA;;AAAA;AAAA;AAAA;;AAaZS,oBAAQC,GAAR;AACAZ,iBAAK,gCAAmB,MAAnB,EAA2B,MAA3B,CAAL;;AAdY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAV;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAkBA,IAAMa;AAAA,uFAAoB,kBAAOf,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAED,kBAAeH,OAAf,CAAuB,4BAAWC,IAAIG,KAAf,+BAAvB,EAAsE;AACzFa,wBAAUhB,IAAIiB,MAAJ,CAAWC;AADoE,aAAtE,CAFC;;AAAA;AAEhBd,kBAFgB;;AAKtBA,mBAAOC,IAAP,GAAcD,OAAOC,IAAP,CAAYC,GAAZ,CAAgB,gBAAQ;AACpC,qBAAO;AACLC,qBAAKC,KAAKD,GADL;AAELE,2BAAWD,KAAKC,SAFX;AAGLC,sBAAMF,KAAKE,IAHN;AAILC,uBAAOH,KAAKG;AAJP,eAAP;AAMD,aAPa,CAAd;AAQAV,gBAAIW,IAAJ,CAAS,0BAAaR,MAAb,CAAT;AAbsB;AAAA;;AAAA;AAAA;AAAA;;AAetBS,oBAAQC,GAAR;AACAZ,iBAAK,gCAAmB,MAAnB,EAA2B,MAA3B,CAAL;;AAhBsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAAA;AAAA;AAAA;AAAA,GAAN;;kBAoBe;AACbH,kBADa;AAEbgB;AAFa,C","file":"controller.js","sourcesContent":["import contentManager from './manager'\nimport { getFromReq } from '../util/pagination'\nimport { formatResult, handlerCustomError } from '../util/format'\nimport { CONTENT_LIMIT_DEFAULT } from '../util/const'\n\nconst findAll = async (req, res, next) => {\n  try {\n    const result = await contentManager.findAll(getFromReq(req.query, CONTENT_LIMIT_DEFAULT ))\n    result.list = result.list.map(item => {\n      return {\n        _id: item._id,\n        createdAt: item.createdAt,\n        hits: item.hits,\n        title: item.title\n      }\n    })\n    res.json(formatResult(result))\n  } catch (e) {\n    console.log(e)\n    next(handlerCustomError(104001, '查询失败'))\n  }\n}\n\nconst findAllByCategory = async (req, res, next) => {\n  try {\n    const result = await contentManager.findAll(getFromReq(req.query, CONTENT_LIMIT_DEFAULT ), {\n      category: req.params.id\n    })\n    result.list = result.list.map(item => {\n      return {\n        _id: item._id,\n        createdAt: item.createdAt,\n        hits: item.hits,\n        title: item.title\n      }\n    })\n    res.json(formatResult(result))\n  } catch (e) {\n    console.log(e)\n    next(handlerCustomError(104002, '查询失败'))\n  }\n}\n\nexport default {\n  findAll,\n  findAllByCategory\n}\n"]}