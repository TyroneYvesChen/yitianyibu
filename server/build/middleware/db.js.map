{"version":3,"sources":["../../src/middleware/db.js"],"names":["connect","conn","connection","mongo","on","error","console","once","log","initUser","gfs","db","mongoose"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA,mBAASA,OAAT;;AAEA,IAAMC,OAAO,mBAASC,UAAtB;AACA,uBAAKC,KAAL,GAAa,mBAASA,KAAtB;;AAEAF,KAAKG,EAAL,CAAQ,OAAR,EAAiB,UAACC,KAAD,EAAW;AAC1BC,UAAQD,KAAR,CAAc,OAAd,EAAuBA,KAAvB;AACD,CAFD;AAGAJ,KAAKM,IAAL,CAAU,MAAV,EAAkB,YAAM;AACtBD,UAAQE,GAAR;AACA,oBAAYC,QAAZ;AACD,CAHD;;AAKA,IAAIC,MAAM,4BAAKT,KAAKU,EAAV,CAAV;;QAGEC,Q;QACAF,G,GAAAA,G","file":"db.js","sourcesContent":["import mongoose from 'mongoose'\nimport Grid from 'gridfs-stream'\nimport { MONGO_URL, MONGO_DB } from '../config'\nimport userManager from '../lib/user/manager'\n\nmongoose.connect(`${MONGO_URL}${MONGO_DB}`)\n\nconst conn = mongoose.connection\nGrid.mongo = mongoose.mongo\n\nconn.on('error', (error) => {\n  console.error('连接错误:', error)\n})\nconn.once('open', () => {\n  console.log(`数据库已连接 数据库 [${MONGO_DB}]`)\n  userManager.initUser()\n})\n\nlet gfs = Grid(conn.db)\n\nexport {\n  mongoose,\n  gfs\n}\n"]}